<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.3 Un esquema de muestreo para BigCity | Análisis de encuestas de hogares con R</title>
  <meta name="description" content="Este es el repositorio del libro Análisis de encuestas de hogares con R." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3.3 Un esquema de muestreo para BigCity | Análisis de encuestas de hogares con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Este es el repositorio del libro Análisis de encuestas de hogares con R." />
  <meta name="github-repo" content="psirusteam/LibroAEHR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.3 Un esquema de muestreo para BigCity | Análisis de encuestas de hogares con R" />
  
  <meta name="twitter:description" content="Este es el repositorio del libro Análisis de encuestas de hogares con R." />
  

<meta name="author" content="Andrés Gutiérrez, Cristian Téllez, Stalyn Guerrero" />


<meta name="date" content="2024-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="la-base-de-datos-bigcity.html"/>
<link rel="next" href="calibración-de-los-factores-de-expansión.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de encuestas de hogares con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="manejando-una-base-de-encuestas-de-hogares-con-r.html"><a href="manejando-una-base-de-encuestas-de-hogares-con-r.html"><i class="fa fa-check"></i><b>2</b> Manejando una base de encuestas de hogares con <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="fundamentos-básicos-de-r-y-rstudio.html"><a href="fundamentos-básicos-de-r-y-rstudio.html"><i class="fa fa-check"></i><b>2.1</b> Fundamentos básicos de <code>R</code> y <code>Rstudio</code></a></li>
<li class="chapter" data-level="2.2" data-path="creación-de-proyectos-en-r.html"><a href="creación-de-proyectos-en-r.html"><i class="fa fa-check"></i><b>2.2</b> Creación de proyectos en <code>R</code></a></li>
<li class="chapter" data-level="2.3" data-path="lectura-de-las-bases-de-datos-y-procesamientos-básicos.html"><a href="lectura-de-las-bases-de-datos-y-procesamientos-básicos.html"><i class="fa fa-check"></i><b>2.3</b> Lectura de las bases de datos y procesamientos básicos</a></li>
<li class="chapter" data-level="2.4" data-path="el-operador-pipeline.html"><a href="el-operador-pipeline.html"><i class="fa fa-check"></i><b>2.4</b> El operador <code>pipeline</code> (%&gt;%)</a></li>
<li class="chapter" data-level="2.5" data-path="creación-de-variables-y-resumen-de-conteos.html"><a href="creación-de-variables-y-resumen-de-conteos.html"><i class="fa fa-check"></i><b>2.5</b> Creación de variables y resumen de conteos</a></li>
<li class="chapter" data-level="2.6" data-path="algunas-estadísticas-descriptivas-sobre-la-base-de-datos.html"><a href="algunas-estadísticas-descriptivas-sobre-la-base-de-datos.html"><i class="fa fa-check"></i><b>2.6</b> Algunas estadísticas descriptivas sobre la base de datos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="conceptos-básicos-en-encuestas-de-hogares.html"><a href="conceptos-básicos-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>3</b> Conceptos básicos en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="3.1" data-path="unidades-y-marcos-de-muestreo.html"><a href="unidades-y-marcos-de-muestreo.html"><i class="fa fa-check"></i><b>3.1</b> Unidades y marcos de muestreo</a></li>
<li class="chapter" data-level="3.2" data-path="la-base-de-datos-bigcity.html"><a href="la-base-de-datos-bigcity.html"><i class="fa fa-check"></i><b>3.2</b> La base de datos BigCity</a></li>
<li class="chapter" data-level="3.3" data-path="un-esquema-de-muestreo-para-bigcity.html"><a href="un-esquema-de-muestreo-para-bigcity.html"><i class="fa fa-check"></i><b>3.3</b> Un esquema de muestreo para BigCity</a></li>
<li class="chapter" data-level="3.4" data-path="calibración-de-los-factores-de-expansión.html"><a href="calibración-de-los-factores-de-expansión.html"><i class="fa fa-check"></i><b>3.4</b> Calibración de los factores de expansión</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="análisis-de-variables-continuas.html"><a href="análisis-de-variables-continuas.html"><i class="fa fa-check"></i><b>4</b> Análisis de variables continuas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="definición-del-diseño-de-muestreo.html"><a href="definición-del-diseño-de-muestreo.html"><i class="fa fa-check"></i><b>4.1</b> Definición del diseño de muestreo</a></li>
<li class="chapter" data-level="4.2" data-path="estimación-puntual.html"><a href="estimación-puntual.html"><i class="fa fa-check"></i><b>4.2</b> Estimación puntual</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-de-totales"><i class="fa fa-check"></i><b>4.2.1</b> Estimación de totales</a></li>
<li class="chapter" data-level="4.2.2" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-de-promedios"><i class="fa fa-check"></i><b>4.2.2</b> Estimación de promedios</a></li>
<li class="chapter" data-level="4.2.3" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-de-medidas-de-dispersión-y-localización"><i class="fa fa-check"></i><b>4.2.3</b> Estimación de medidas de dispersión y localización</a></li>
<li class="chapter" data-level="4.2.4" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-del-coeficiente-de-gini"><i class="fa fa-check"></i><b>4.2.4</b> Estimación del coeficiente de Gini</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="relación-entre-varias-variables.html"><a href="relación-entre-varias-variables.html"><i class="fa fa-check"></i><b>4.3</b> Relación entre varias variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="relación-entre-varias-variables.html"><a href="relación-entre-varias-variables.html#estimación-de-razones"><i class="fa fa-check"></i><b>4.3.1</b> Estimación de razones</a></li>
<li class="chapter" data-level="4.3.2" data-path="relación-entre-varias-variables.html"><a href="relación-entre-varias-variables.html#prueba-de-hipótesis-para-la-diferencia-de-medias"><i class="fa fa-check"></i><b>4.3.2</b> Prueba de hipótesis para la diferencia de medias</a></li>
<li class="chapter" data-level="4.3.3" data-path="relación-entre-varias-variables.html"><a href="relación-entre-varias-variables.html#contrastes"><i class="fa fa-check"></i><b>4.3.3</b> Contrastes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="análisis-de-variables-categóricas.html"><a href="análisis-de-variables-categóricas.html"><i class="fa fa-check"></i><b>5</b> Análisis de variables categóricas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="definición-del-diseño-de-muestreo-1.html"><a href="definición-del-diseño-de-muestreo-1.html"><i class="fa fa-check"></i><b>5.1</b> Definición del diseño de muestreo</a></li>
<li class="chapter" data-level="5.2" data-path="estimación-puntual-1.html"><a href="estimación-puntual-1.html"><i class="fa fa-check"></i><b>5.2</b> Estimación puntual</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="estimación-puntual-1.html"><a href="estimación-puntual-1.html#estimaciones-de-tamaños"><i class="fa fa-check"></i><b>5.2.1</b> Estimaciones de tamaños</a></li>
<li class="chapter" data-level="5.2.2" data-path="estimación-puntual-1.html"><a href="estimación-puntual-1.html#estimación-de-proporciones"><i class="fa fa-check"></i><b>5.2.2</b> Estimación de proporciones</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="relación-entre-varias-variables-1.html"><a href="relación-entre-varias-variables-1.html"><i class="fa fa-check"></i><b>5.3</b> Relación entre varias variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="relación-entre-varias-variables-1.html"><a href="relación-entre-varias-variables-1.html#tablas"><i class="fa fa-check"></i><b>5.3.1</b> Tablas</a></li>
<li class="chapter" data-level="5.3.2" data-path="relación-entre-varias-variables-1.html"><a href="relación-entre-varias-variables-1.html#pruebas-de-independencia"><i class="fa fa-check"></i><b>5.3.2</b> Pruebas de independencia</a></li>
<li class="chapter" data-level="5.3.3" data-path="relación-entre-varias-variables-1.html"><a href="relación-entre-varias-variables-1.html#diferencia-de-proporciones-y-contrastes"><i class="fa fa-check"></i><b>5.3.3</b> Diferencia de proporciones y contrastes</a></li>
<li class="chapter" data-level="5.3.4" data-path="relación-entre-varias-variables-1.html"><a href="relación-entre-varias-variables-1.html#razones-de-odds"><i class="fa fa-check"></i><b>5.3.4</b> Razones de odds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="análisis-gráfico.html"><a href="análisis-gráfico.html"><i class="fa fa-check"></i><b>6</b> Análisis gráfico</a>
<ul>
<li class="chapter" data-level="6.1" data-path="análisis-gráfico-con-la-librería-survey.html"><a href="análisis-gráfico-con-la-librería-survey.html"><i class="fa fa-check"></i><b>6.1</b> Análisis gráfico con la librería <code>survey</code></a></li>
<li class="chapter" data-level="6.2" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html"><i class="fa fa-check"></i><b>6.2</b> Análisis gráfico con la librería <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html#definición-del-tema"><i class="fa fa-check"></i><b>6.2.1</b> Definición del tema</a></li>
<li class="chapter" data-level="6.2.2" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html#histogramas"><i class="fa fa-check"></i><b>6.2.2</b> Histogramas</a></li>
<li class="chapter" data-level="6.2.3" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html#densidades"><i class="fa fa-check"></i><b>6.2.3</b> Densidades</a></li>
<li class="chapter" data-level="6.2.4" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html#diagramas-de-caja"><i class="fa fa-check"></i><b>6.2.4</b> Diagramas de caja</a></li>
<li class="chapter" data-level="6.2.5" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html#diagramas-de-dispersión"><i class="fa fa-check"></i><b>6.2.5</b> Diagramas de dispersión</a></li>
<li class="chapter" data-level="6.2.6" data-path="análisis-gráfico-con-la-librería-ggplot2.html"><a href="análisis-gráfico-con-la-librería-ggplot2.html#diagrama-de-barras"><i class="fa fa-check"></i><b>6.2.6</b> Diagrama de barras</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>6.3</b> Mapas</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html"><i class="fa fa-check"></i><b>7</b> Modelos de regresión</a>
<ul>
<li class="chapter" data-level="7.1" data-path="definiciones-básicas.html"><a href="definiciones-básicas.html"><i class="fa fa-check"></i><b>7.1</b> Definiciones básicas</a></li>
<li class="chapter" data-level="7.2" data-path="estimación-de-los-parámetros-en-un-modelo-de-regresión-con-muestras-complejas..html"><a href="estimación-de-los-parámetros-en-un-modelo-de-regresión-con-muestras-complejas..html"><i class="fa fa-check"></i><b>7.2</b> Estimación de los parámetros en un modelo de regresión con muestras complejas.</a></li>
<li class="chapter" data-level="7.3" data-path="la-ponderación-de-pfeffermann.html"><a href="la-ponderación-de-pfeffermann.html"><i class="fa fa-check"></i><b>7.3</b> La ponderación de Pfeffermann</a></li>
<li class="chapter" data-level="7.4" data-path="diagnóstico-del-modelo.html"><a href="diagnóstico-del-modelo.html"><i class="fa fa-check"></i><b>7.4</b> Diagnóstico del modelo</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="diagnóstico-del-modelo.html"><a href="diagnóstico-del-modelo.html#coeficientes-de-determinación"><i class="fa fa-check"></i><b>7.4.1</b> Coeficientes de determinación</a></li>
<li class="chapter" data-level="7.4.2" data-path="diagnóstico-del-modelo.html"><a href="diagnóstico-del-modelo.html#residuales-estandarizados"><i class="fa fa-check"></i><b>7.4.2</b> Residuales estandarizados</a></li>
<li class="chapter" data-level="7.4.3" data-path="diagnóstico-del-modelo.html"><a href="diagnóstico-del-modelo.html#observaciones-influyentes"><i class="fa fa-check"></i><b>7.4.3</b> Observaciones influyentes</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="inferencia-sobre-los-parámetros-del-modelo.html"><a href="inferencia-sobre-los-parámetros-del-modelo.html"><i class="fa fa-check"></i><b>7.5</b> Inferencia sobre los parámetros del Modelo</a></li>
<li class="chapter" data-level="7.6" data-path="estimación-y-predicción.html"><a href="estimación-y-predicción.html"><i class="fa fa-check"></i><b>7.6</b> Estimación y predicción</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>8</b> Modelos lineales generalizados</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelo-de-regresión-logistica-para-proporciones.html"><a href="modelo-de-regresión-logistica-para-proporciones.html"><i class="fa fa-check"></i><b>8.1</b> Modelo de regresión logistica para proporciones</a></li>
<li class="chapter" data-level="8.2" data-path="modelo-log-lineal-para-tablas-de-contingencia.html"><a href="modelo-log-lineal-para-tablas-de-contingencia.html"><i class="fa fa-check"></i><b>8.2</b> Modelo log-lineal para tablas de contingencia</a></li>
<li class="chapter" data-level="8.3" data-path="modelo-multinomial-para-variables-con-múltiples-categorías.html"><a href="modelo-multinomial-para-variables-con-múltiples-categorías.html"><i class="fa fa-check"></i><b>8.3</b> Modelo multinomial para variables con múltiples categorías</a></li>
<li class="chapter" data-level="8.4" data-path="modelo-gamma-para-variables-continuas-positivas.html"><a href="modelo-gamma-para-variables-continuas-positivas.html"><i class="fa fa-check"></i><b>8.4</b> Modelo Gamma para variables continuas positivas</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelos-multinivel.html"><a href="modelos-multinivel.html"><i class="fa fa-check"></i><b>9</b> Modelos multinivel</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelo-con-intercepto-aleatorio.html"><a href="modelo-con-intercepto-aleatorio.html"><i class="fa fa-check"></i><b>9.1</b> Modelo con intercepto aleatorio</a></li>
<li class="chapter" data-level="9.2" data-path="modelo-con-pendiente-aleatoria.html"><a href="modelo-con-pendiente-aleatoria.html"><i class="fa fa-check"></i><b>9.2</b> Modelo con pendiente aleatoria</a></li>
<li class="chapter" data-level="9.3" data-path="modelo-con-intercepto-y-pendiente-aleatoria.html"><a href="modelo-con-intercepto-y-pendiente-aleatoria.html"><i class="fa fa-check"></i><b>9.3</b> Modelo con intercepto y pendiente aleatoria</a></li>
<li class="chapter" data-level="9.4" data-path="modelo-logístico-multinivel..html"><a href="modelo-logístico-multinivel..html"><i class="fa fa-check"></i><b>9.4</b> Modelo logístico multinivel.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="imputación-múltiple-en-encuestas-de-hogares.html"><a href="imputación-múltiple-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>10</b> Imputación múltiple en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tres-patrones-para-la-ausencia-de-respuesta.html"><a href="tres-patrones-para-la-ausencia-de-respuesta.html"><i class="fa fa-check"></i><b>10.1</b> Tres patrones para la ausencia de respuesta</a></li>
<li class="chapter" data-level="10.2" data-path="imputación-por-la-media-no-condicional..html"><a href="imputación-por-la-media-no-condicional..html"><i class="fa fa-check"></i><b>10.2</b> Imputación por la media no condicional.</a></li>
<li class="chapter" data-level="10.3" data-path="imputación-por-la-media-condicional.html"><a href="imputación-por-la-media-condicional.html"><i class="fa fa-check"></i><b>10.3</b> Imputación por la media condicional</a></li>
<li class="chapter" data-level="10.4" data-path="imputación-por-hot-deck.html"><a href="imputación-por-hot-deck.html"><i class="fa fa-check"></i><b>10.4</b> Imputación por <em>Hot-Deck</em></a></li>
<li class="chapter" data-level="10.5" data-path="imputación-por-regresión.html"><a href="imputación-por-regresión.html"><i class="fa fa-check"></i><b>10.5</b> Imputación por regresión</a></li>
<li class="chapter" data-level="10.6" data-path="imputación-por-el-vecino-más-cercano.html"><a href="imputación-por-el-vecino-más-cercano.html"><i class="fa fa-check"></i><b>10.6</b> Imputación por el vecino más cercano</a></li>
<li class="chapter" data-level="10.7" data-path="imputación-por-el-vecino-más-cercano-con-regresión.html"><a href="imputación-por-el-vecino-más-cercano-con-regresión.html"><i class="fa fa-check"></i><b>10.7</b> Imputación por el vecino más cercano con regresión</a></li>
<li class="chapter" data-level="10.8" data-path="imputación-múltiple..html"><a href="imputación-múltiple..html"><i class="fa fa-check"></i><b>10.8</b> Imputación múltiple.</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="estimación-de-parámetros-para-modelos-en-encuestas-complejas.html"><a href="estimación-de-parámetros-para-modelos-en-encuestas-complejas.html"><i class="fa fa-check"></i><b>11</b> Estimación de parámetros para modelos en encuestas complejas</a>
<ul>
<li class="chapter" data-level="11.1" data-path="acerca-de-las-muestras-aleatorias-y-su-análisis.html"><a href="acerca-de-las-muestras-aleatorias-y-su-análisis.html"><i class="fa fa-check"></i><b>11.1</b> Acerca de las muestras aleatorias y su análisis</a></li>
<li class="chapter" data-level="11.2" data-path="modelos-de-superpoblación.html"><a href="modelos-de-superpoblación.html"><i class="fa fa-check"></i><b>11.2</b> Modelos de superpoblación</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="modelos-de-superpoblación.html"><a href="modelos-de-superpoblación.html#primer-proceso-inferencial-el-modelo"><i class="fa fa-check"></i><b>11.2.1</b> Primer proceso inferencial: el modelo</a></li>
<li class="chapter" data-level="11.2.2" data-path="modelos-de-superpoblación.html"><a href="modelos-de-superpoblación.html#segundo-proceso-inferencial-el-muestreo"><i class="fa fa-check"></i><b>11.2.2</b> Segundo proceso inferencial: el muestreo</a></li>
<li class="chapter" data-level="11.2.3" data-path="modelos-de-superpoblación.html"><a href="modelos-de-superpoblación.html#inferencia-doble-los-modelos-y-el-muestreo"><i class="fa fa-check"></i><b>11.2.3</b> Inferencia doble: los modelos y el muestreo</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="método-de-máxima-verosimilitud.html"><a href="método-de-máxima-verosimilitud.html"><i class="fa fa-check"></i><b>11.3</b> Método de Máxima Verosimilitud</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="método-de-máxima-verosimilitud.html"><a href="método-de-máxima-verosimilitud.html#mv-para-una-distribución-bernoulli"><i class="fa fa-check"></i><b>11.3.1</b> MV para una distribución Bernoulli</a></li>
<li class="chapter" data-level="11.3.2" data-path="método-de-máxima-verosimilitud.html"><a href="método-de-máxima-verosimilitud.html#mv-para-una-distribución-normal"><i class="fa fa-check"></i><b>11.3.2</b> MV para una distribución normal</a></li>
<li class="chapter" data-level="11.3.3" data-path="método-de-máxima-verosimilitud.html"><a href="método-de-máxima-verosimilitud.html#mv-para-una-regresión-lineal-múltiple"><i class="fa fa-check"></i><b>11.3.3</b> MV para una regresión lineal múltiple</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="método-de-máxima-pseudo-verosimilitud.html"><a href="método-de-máxima-pseudo-verosimilitud.html"><i class="fa fa-check"></i><b>11.4</b> Método de Máxima Pseudo-Verosimilitud</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="método-de-máxima-pseudo-verosimilitud.html"><a href="método-de-máxima-pseudo-verosimilitud.html#mpv-para-una-distribución-bernoulli"><i class="fa fa-check"></i><b>11.4.1</b> MPV para una distribución Bernoulli</a></li>
<li class="chapter" data-level="11.4.2" data-path="método-de-máxima-pseudo-verosimilitud.html"><a href="método-de-máxima-pseudo-verosimilitud.html#mpv-para-una-distribución-normal"><i class="fa fa-check"></i><b>11.4.2</b> MPV para una distribución normal</a></li>
<li class="chapter" data-level="11.4.3" data-path="método-de-máxima-pseudo-verosimilitud.html"><a href="método-de-máxima-pseudo-verosimilitud.html#mpv-para-una-regresión-múltiple"><i class="fa fa-check"></i><b>11.4.3</b> MPV para una regresión múltiple</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a Análisis de encuestas de hogares con R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de encuestas de hogares con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="un-esquema-de-muestreo-para-bigcity" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Un esquema de muestreo para BigCity<a href="un-esquema-de-muestreo-para-bigcity.html#un-esquema-de-muestreo-para-bigcity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta sección se establecerán las condiciones de selección de una muestra probabilística correspondiente con un esquema tradicional en la región. Los diseños de muestreo en las encuestas de hogares se caracterizan por ser <strong>diseños complejos</strong> los cuales involucran, entre otras, más de una etapa en la selección de las unidades de observación, estratos y estimadores complejos. En su mayoría, las unidades primarias de muestreo son seleccionadas dentro de los estratos.</p>
<p>Es muy común que, en las encuestas de hogares de la región, se formen estratos geográficos, socioeconómicos o una mezcla de ellos. Según la teoría de muestreo, los estratos corresponden con subgrupos poblacionales que abarcan grandes subdivisones de la población objetivo. Además la inferencia en los estratos se hace de forma independiente; esto es, las estimaciones del total, así como el cálculo y estimación de la varianza son el resultado de añadir o sumar para cada estrato la respectiva cantidad.</p>
<p>Se asume que, dentro de cada estrato <span class="math inline">\(U_h\)</span> (<span class="math inline">\(h=1,\ldots, H\)</span>) existen <span class="math inline">\(N_{Ih}\)</span> unidades primarias de muestreo, de las cuales se selecciona una muestra <span class="math inline">\(s_{Ih}\)</span> de tamaño <span class="math inline">\(n_{Ih}\)</span> mediante un diseño de muestreo aleatorio simple. Estas muestras <span class="math inline">\(s_{Ih}\)</span> corresponden con conglomerados o unidades primarias de muestreo (UPM) constituidas por unión o escisión de los sectores censales del país. Además, se supone que el sub-muestreo dentro de cada unidad primaria seleccionada es también aleatorio simple. En este sentido, para cada unidad primaria de muestreo seleccionada <span class="math inline">\(i\in s_{Ih}\)</span> de tamaño <span class="math inline">\(N_i\)</span> se selecciona una muestra <span class="math inline">\(s_i\)</span> de elementos de tamaño <span class="math inline">\(n_i\)</span>.</p>
<p>En esta sección se utilizarán las funciones estudiadas en el capítulo anterior para la manipulación de la base de datos de ejemplo. Inicialmente, se cargarán las librerías <code>ggplot2</code> que permitirá generar gráficos de alta calidad en <code>R</code>, <code>TeachingSampling</code> que permite tomar muestras probabilísticas utilizando los diseños de muestreo usuales, <code>survey</code> y <code>srvyr</code> que permitirán definir los diseños muestrales y por último <code>dplyr</code> que permite la manipulación de las bases de datos.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb59-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb59-2" tabindex="-1"></a><span class="fu">library</span>(TeachingSampling)</span>
<span id="cb59-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb59-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb59-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb59-4" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb59-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb59-5" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span></code></pre></div>
<p>Una vez cargada las librerías, se procede a realizar una agregación de las 1664 unidades primarias de muestreo en esta base de datos y calcular, para cada una de ellas, la cantidad de personas, el total de ingresos y total de gastos, además de la identificación de su estrato de muestreo:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;BigCity&#39;</span>)</span>
<span id="cb60-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-3" tabindex="-1"></a>FrameI <span class="ot">&lt;-</span> BigCity <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(PSU) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb60-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-5" tabindex="-1"></a>    <span class="at">Stratum =</span> <span class="fu">unique</span>(Stratum),</span>
<span id="cb60-6"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-6" tabindex="-1"></a>    <span class="at">Persons =</span> <span class="fu">n</span>(),</span>
<span id="cb60-7"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-7" tabindex="-1"></a>    <span class="at">Income =</span> <span class="fu">sum</span>(Income),</span>
<span id="cb60-8"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-8" tabindex="-1"></a>    <span class="at">Expenditure =</span> <span class="fu">sum</span>(Expenditure)</span>
<span id="cb60-9"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-9" tabindex="-1"></a>  )</span>
<span id="cb60-10"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-10" tabindex="-1"></a></span>
<span id="cb60-11"><a href="un-esquema-de-muestreo-para-bigcity.html#cb60-11" tabindex="-1"></a><span class="fu">attach</span>(FrameI)</span></code></pre></div>
<p>El siguiente código computacional muestra la información de las unidades primarias de muestreo.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb61-1" tabindex="-1"></a><span class="fu">head</span>(FrameI, <span class="dv">10</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PSU</th>
<th align="left">Stratum</th>
<th align="right">Persons</th>
<th align="right">Income</th>
<th align="right">Expenditure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PSU0001</td>
<td align="left">idStrt001</td>
<td align="right">118</td>
<td align="right">70911.72</td>
<td align="right">44231.78</td>
</tr>
<tr class="even">
<td align="left">PSU0002</td>
<td align="left">idStrt001</td>
<td align="right">136</td>
<td align="right">68886.60</td>
<td align="right">38381.90</td>
</tr>
<tr class="odd">
<td align="left">PSU0003</td>
<td align="left">idStrt001</td>
<td align="right">96</td>
<td align="right">37213.10</td>
<td align="right">19494.78</td>
</tr>
<tr class="even">
<td align="left">PSU0004</td>
<td align="left">idStrt001</td>
<td align="right">88</td>
<td align="right">36926.46</td>
<td align="right">24030.74</td>
</tr>
<tr class="odd">
<td align="left">PSU0005</td>
<td align="left">idStrt001</td>
<td align="right">110</td>
<td align="right">57493.88</td>
<td align="right">31142.36</td>
</tr>
<tr class="even">
<td align="left">PSU0006</td>
<td align="left">idStrt001</td>
<td align="right">116</td>
<td align="right">75272.06</td>
<td align="right">43473.28</td>
</tr>
<tr class="odd">
<td align="left">PSU0007</td>
<td align="left">idStrt001</td>
<td align="right">68</td>
<td align="right">33027.84</td>
<td align="right">21832.66</td>
</tr>
<tr class="even">
<td align="left">PSU0008</td>
<td align="left">idStrt001</td>
<td align="right">136</td>
<td align="right">64293.02</td>
<td align="right">47660.02</td>
</tr>
<tr class="odd">
<td align="left">PSU0009</td>
<td align="left">idStrt001</td>
<td align="right">122</td>
<td align="right">33156.14</td>
<td align="right">23292.16</td>
</tr>
<tr class="even">
<td align="left">PSU0010</td>
<td align="left">idStrt002</td>
<td align="right">70</td>
<td align="right">65253.78</td>
<td align="right">37114.76</td>
</tr>
</tbody>
</table>
<p>Ahora bien, se va a suponer que en cada estrato se tomará una muestra de dos UPM. Suponiendo que el muestreo dentro del estrato es aleatorio simple, el factor de expansión será la división entre el número total de UPM en el estrato y el tamaño de muestra. Para calcular los tamaños poblacionales de los estratos (NIh), definir los tamaños de muestra dentro de cada estrato (nIh), y calcular el factor de expansión, se realiza de la siguiente manera:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-1" tabindex="-1"></a>sizes <span class="ot">=</span> FrameI <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Stratum) <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">NIh =</span> <span class="fu">n</span>(),</span>
<span id="cb62-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-3" tabindex="-1"></a>            <span class="at">nIh =</span> <span class="dv">2</span>,</span>
<span id="cb62-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-4" tabindex="-1"></a>            <span class="at">dI =</span> NIh <span class="sc">/</span> nIh)</span>
<span id="cb62-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-5" tabindex="-1"></a></span>
<span id="cb62-6"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-6" tabindex="-1"></a>NIh <span class="ot">&lt;-</span> sizes<span class="sc">$</span>NIh</span>
<span id="cb62-7"><a href="un-esquema-de-muestreo-para-bigcity.html#cb62-7" tabindex="-1"></a>nIh <span class="ot">&lt;-</span> sizes<span class="sc">$</span>nIh</span></code></pre></div>
<p>La siguiente tabla ejemplifica el esquema de muestreo para los primeros 10 estratos de la población.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb63-1" tabindex="-1"></a><span class="fu">head</span>(sizes, <span class="dv">10</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Stratum</th>
<th align="right">NIh</th>
<th align="right">nIh</th>
<th align="right">dI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
</tr>
<tr class="even">
<td align="left">idStrt002</td>
<td align="right">11</td>
<td align="right">2</td>
<td align="right">5.5</td>
</tr>
<tr class="odd">
<td align="left">idStrt003</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">3.5</td>
</tr>
<tr class="even">
<td align="left">idStrt004</td>
<td align="right">13</td>
<td align="right">2</td>
<td align="right">6.5</td>
</tr>
<tr class="odd">
<td align="left">idStrt005</td>
<td align="right">11</td>
<td align="right">2</td>
<td align="right">5.5</td>
</tr>
<tr class="even">
<td align="left">idStrt006</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.5</td>
</tr>
<tr class="odd">
<td align="left">idStrt007</td>
<td align="right">14</td>
<td align="right">2</td>
<td align="right">7.0</td>
</tr>
<tr class="even">
<td align="left">idStrt008</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">3.5</td>
</tr>
<tr class="odd">
<td align="left">idStrt009</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td align="left">idStrt010</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<p>Como se desea extraer una muestra probabilística bajo un diseño aleatorio simple estratificado, se procede a utilizar la función <code>S.STSI</code> de la librería <code>TeachingSampling</code> como se muestra a continuación:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb64-1" tabindex="-1"></a>samI <span class="ot">&lt;-</span> <span class="fu">S.STSI</span>(Stratum, NIh, nIh)</span>
<span id="cb64-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb64-2" tabindex="-1"></a>UI <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(FrameI<span class="sc">$</span>PSU))</span>
<span id="cb64-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb64-3" tabindex="-1"></a>sampleI <span class="ot">&lt;-</span> UI[samI]</span></code></pre></div>
<p>En este caso, el objeto <code>sampleI</code> contendrá la información asociada a las UPM que fueron seleccionadas en esta primera etapa. Ahora bien, con la función <code>left_join</code> se procede a pegar los tamaños muestrales a aquellas UPM’s que fueron seleccionadas en la muestra:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb65-1" tabindex="-1"></a>FrameII <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sizes,</span>
<span id="cb65-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb65-2" tabindex="-1"></a>                     BigCity[<span class="fu">which</span>(BigCity<span class="sc">$</span>PSU <span class="sc">%in%</span> sampleI),])</span>
<span id="cb65-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb65-3" tabindex="-1"></a><span class="fu">attach</span>(FrameII)</span></code></pre></div>
<p>Una vez se tiene la base de datos con la muestra de UMP, se selecciona aquellas variables que son de interés para el estudio como sigue a continuación:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb66-1" tabindex="-1"></a><span class="fu">head</span>(FrameII, <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Stratum<span class="sc">:</span>Zone)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Stratum</th>
<th align="right">NIh</th>
<th align="right">nIh</th>
<th align="right">dI</th>
<th align="left">HHID</th>
<th align="left">PersonID</th>
<th align="left">PSU</th>
<th align="left">Zone</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00082</td>
<td align="left">idPer01</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00082</td>
<td align="left">idPer02</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00082</td>
<td align="left">idPer03</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00082</td>
<td align="left">idPer04</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00083</td>
<td align="left">idPer01</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00083</td>
<td align="left">idPer02</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00084</td>
<td align="left">idPer01</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00084</td>
<td align="left">idPer02</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00084</td>
<td align="left">idPer03</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idHH00084</td>
<td align="left">idPer04</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
</tbody>
</table>
<p>Luego de tener la información muestral de la primera etapa, en la base <code>FrameII</code> se procede a calcular los tamaños de muestra dentro de cada UPM. En este caso, a modo de ejemplo, se tomará el 10% del tamaño de la UPM como tamaño de muestra en la segunda etapa y se utilizará la función <code>ceiling</code> la cual aproxima al siguiente entero.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-1" tabindex="-1"></a>HHdb <span class="ot">&lt;-</span> FrameII <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-2" tabindex="-1"></a>  <span class="fu">group_by</span>(PSU) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Ni =</span> <span class="fu">length</span>(<span class="fu">unique</span>(HHID)),</span>
<span id="cb67-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-4" tabindex="-1"></a>            <span class="at">ni =</span> <span class="fu">ceiling</span>(Ni <span class="sc">*</span> <span class="fl">0.1</span>))</span>
<span id="cb67-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-5" tabindex="-1"></a></span>
<span id="cb67-6"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-6" tabindex="-1"></a>Ni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HHdb<span class="sc">$</span>Ni)</span>
<span id="cb67-7"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-7" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(Ni <span class="sc">*</span> <span class="fl">0.1</span>)</span>
<span id="cb67-8"><a href="un-esquema-de-muestreo-para-bigcity.html#cb67-8" tabindex="-1"></a><span class="fu">sum</span>(ni)</span></code></pre></div>
<pre><code>## [1] 691</code></pre>
<p>Teniendo el vector de tamaños de hogares en cada UPM, junto con su correspondiente tamaño de muestra, se procede a realizar la selección mediante un muestreo aleatorio simple con la función <code>S.SI</code> de la librería <code>TeachingSampling</code>. A modo ilustrativo, la selección en la segunda etapa del diseño se realizará, inicialmente para la primera UPM. Posterior a eso, se realizará un ciclo con la función <code>for</code> para hacerlo con las demás UPM. Para la primera UPM se realiza de la siguiente manera:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-1" tabindex="-1"></a>sam <span class="ot">=</span> <span class="fu">S.SI</span>(Ni[<span class="dv">1</span>], ni[<span class="dv">1</span>])</span>
<span id="cb69-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-2" tabindex="-1"></a></span>
<span id="cb69-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-3" tabindex="-1"></a>clusterII <span class="ot">=</span> FrameII[<span class="fu">which</span>(FrameII<span class="sc">$</span>PSU <span class="sc">==</span> sampleI[<span class="dv">1</span>]), ]</span>
<span id="cb69-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-4" tabindex="-1"></a>sam.HH <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">HHID =</span> <span class="fu">unique</span>(clusterII<span class="sc">$</span>HHID)[sam])</span>
<span id="cb69-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-5" tabindex="-1"></a></span>
<span id="cb69-6"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-6" tabindex="-1"></a>clusterHH <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sam.HH, clusterII, <span class="at">by =</span> <span class="st">&quot;HHID&quot;</span>)</span>
<span id="cb69-7"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-7" tabindex="-1"></a>clusterHH<span class="sc">$</span>dki <span class="ot">&lt;-</span> Ni[<span class="dv">1</span>] <span class="sc">/</span> ni[<span class="dv">1</span>]</span>
<span id="cb69-8"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-8" tabindex="-1"></a>clusterHH<span class="sc">$</span>dk <span class="ot">&lt;-</span> clusterHH<span class="sc">$</span>dI <span class="sc">*</span> clusterHH<span class="sc">$</span>dki</span>
<span id="cb69-9"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-9" tabindex="-1"></a></span>
<span id="cb69-10"><a href="un-esquema-de-muestreo-para-bigcity.html#cb69-10" tabindex="-1"></a>sam_data <span class="ot">=</span> clusterHH</span></code></pre></div>
<p>De esta manera se ha seleccionado una muestra de unidades de la primera UPM seleccionada. A continuación se muestran los prime</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb70-1" tabindex="-1"></a><span class="fu">head</span>(sam_data, <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Stratum<span class="sc">:</span>Zone)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Stratum</th>
<th align="right">NIh</th>
<th align="right">nIh</th>
<th align="right">dI</th>
<th align="left">PersonID</th>
<th align="left">PSU</th>
<th align="left">Zone</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer01</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer02</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer01</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer02</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer01</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="even">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer02</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">idStrt001</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">4.5</td>
<td align="left">idPer03</td>
<td align="left">PSU0007</td>
<td align="left">Rural</td>
</tr>
</tbody>
</table>
<p>Para las demás UPM seleccionadas en la primera etapa de muestreo, la selección de la muestra se automatiza con el siguiente código computacional.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Ni)) {</span>
<span id="cb71-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-2" tabindex="-1"></a>  sam <span class="ot">=</span> <span class="fu">S.SI</span>(Ni[i], ni[i])</span>
<span id="cb71-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-3" tabindex="-1"></a>  clusterII <span class="ot">=</span> FrameII[<span class="fu">which</span>(FrameII<span class="sc">$</span>PSU <span class="sc">==</span> sampleI[i]),]</span>
<span id="cb71-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-4" tabindex="-1"></a>  sam.HH <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">HHID =</span> <span class="fu">unique</span>(clusterII<span class="sc">$</span>HHID)[sam])</span>
<span id="cb71-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-5" tabindex="-1"></a>  clusterHH <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sam.HH, clusterII, <span class="at">by =</span> <span class="st">&quot;HHID&quot;</span>)</span>
<span id="cb71-6"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-6" tabindex="-1"></a>  clusterHH<span class="sc">$</span>dki <span class="ot">&lt;-</span> Ni[i] <span class="sc">/</span> ni[i]</span>
<span id="cb71-7"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-7" tabindex="-1"></a>  clusterHH<span class="sc">$</span>dk <span class="ot">&lt;-</span> clusterHH<span class="sc">$</span>dI <span class="sc">*</span> clusterHH<span class="sc">$</span>dki</span>
<span id="cb71-8"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-8" tabindex="-1"></a>  data1 <span class="ot">=</span> clusterHH</span>
<span id="cb71-9"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-9" tabindex="-1"></a>  sam_data <span class="ot">=</span> <span class="fu">rbind</span>(sam_data, data1)</span>
<span id="cb71-10"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-10" tabindex="-1"></a>}</span>
<span id="cb71-11"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-11" tabindex="-1"></a></span>
<span id="cb71-12"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-12" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> sam_data</span>
<span id="cb71-13"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-13" tabindex="-1"></a><span class="fu">attach</span>(encuesta</span>
<span id="cb71-14"><a href="un-esquema-de-muestreo-para-bigcity.html#cb71-14" tabindex="-1"></a>)</span></code></pre></div>
<p>Nótese que la base de datos <code>encuesta</code> contiene una muestra probabilística de la base poblacional BigCity. Una vez se obtiene la muestra (como se mostró anteriormente), el paso siguiente es definir el diseño utilizado y guardarlo como un objeto en <code>R</code> para posteriormente poderlo utilizar y realizar el proceso de estimación de parámetros y cálculo de indicadores. Para realizar esta tarea, se utilizará el paquete <code>srvyr</code> el cual ya fue definido en el capítulo anterior. Para este ejemplo, el diseño de muestreo utilizado fue un estratificado-bietápico en el cual, los estratos correspondieron a la variable <code>Stratum</code>, las UPM correspondieron a la variable <code>PSU</code>, los factores de expansión<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> están en la variable <code>dk</code> y por último, se le indica a la función <code>as_survey_design</code> que las UPM’s están dentro de los estrato con el argumento <code>nest = T</code>. A continuación, se presenta el código computacional:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-1" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-2" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb72-3"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-3" tabindex="-1"></a>    <span class="at">strata =</span> Stratum,</span>
<span id="cb72-4"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-4" tabindex="-1"></a>    <span class="at">ids =</span> PSU,</span>
<span id="cb72-5"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-5" tabindex="-1"></a>    <span class="at">weights =</span> dk,</span>
<span id="cb72-6"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-6" tabindex="-1"></a>    <span class="at">nest =</span> T</span>
<span id="cb72-7"><a href="un-esquema-de-muestreo-para-bigcity.html#cb72-7" tabindex="-1"></a>  )</span></code></pre></div>
<p>Ya definido el diseño de muestreo como un objeto de <code>R</code> se puede empezar a extraer información del mismo. Por ejemplo, se pueden extraer los pesos de muestreo de dicho diseño con la función <code>weights</code> y luego sumarlos para revisar hasta cuánto me está expandiendo mi muestra. El código es el siguiente:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="un-esquema-de-muestreo-para-bigcity.html#cb73-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">weights</span>(diseno))</span></code></pre></div>
<pre><code>## [1] 146712.8</code></pre>
<p>Como se puede observar, el tamaño poblacional estimado utilizando el diseño propuesto es de <span class="math inline">\(140579.2\)</span>. Sin embargo, el tamaño poblacional de la base BigCity es de <span class="math inline">\(150266\)</span>. Es normal que esto suceda pero debe ser corregido puesto que la suma de los factores de expansión debe sumar el total de la población. La solución para esto es calibrar los pesos de muestreo que se abordará a continuación.</p>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>El factor de expansión es el número de elementos menos uno de la población (no incluidos en la muestra) representados por el elemento incluido. Está inducido por el inverso de la probabilidad de inclusión.<a href="un-esquema-de-muestreo-para-bigcity.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="la-base-de-datos-bigcity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="calibración-de-los-factores-de-expansión.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/LibroAEHR/03-Conceptos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Análisis de encuestas de hogares con R.pdf", "Análisis de encuestas de hogares con R.epub", "Análisis de encuestas de hogares con R.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
